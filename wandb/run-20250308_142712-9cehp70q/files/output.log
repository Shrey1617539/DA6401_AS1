1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
[[1.e-08 1.e-08 1.e-08 ... 1.e-08 1.e-08 1.e-08]
 [1.e-08 1.e-08 1.e-08 ... 1.e-08 1.e-08 1.e-08]
 [1.e-08 1.e-08 1.e-08 ... 1.e-08 1.e-08 1.e-08]
 ...
 [1.e-08 1.e-08 1.e-08 ... 1.e-08 1.e-08 1.e-08]
 [1.e-08 1.e-08 1.e-08 ... 1.e-08 1.e-08 1.e-08]
 [1.e-08 1.e-08 1.e-08 ... 1.e-08 1.e-08 1.e-08]]
[[0.00211903 0.00187058 0.00204152 0.00170442 0.00199149 0.00185174
  0.00101773 0.00070072 0.00082252 0.00123885 0.00200593 0.00070051
  0.00178423 0.00154287 0.00168047 0.00078341 0.00189125 0.00179744
  0.00131688 0.00152631]
 [0.00403334 0.00502176 0.00442537 0.00490266 0.00431228 0.00474566
  0.00491367 0.00501908 0.00451684 0.00457608 0.00560551 0.00425748
  0.0052979  0.00375222 0.00468833 0.00459501 0.00514274 0.00493183
  0.00551204 0.00518391]
 [0.0036586  0.00417881 0.00502808 0.00389938 0.00367174 0.00330165
  0.00285883 0.00325183 0.00325546 0.00421548 0.00450918 0.00383784
  0.00379693 0.00458164 0.00415567 0.0047164  0.00382812 0.00442043
  0.00412103 0.00460866]
 [0.00324261 0.00310098 0.00374658 0.00344244 0.00328501 0.00318696
  0.00216435 0.003054   0.0035421  0.00296642 0.00383106 0.00291114
  0.00347758 0.00336535 0.00356277 0.00284463 0.00327198 0.00335295
  0.00377455 0.00342611]
 [0.00052033 0.0009738  0.00107691 0.00082254 0.00090546 0.00058142
  0.00053548 0.00071241 0.00070973 0.00059417 0.00108993 0.0008284
  0.0006312  0.00074945 0.00048967 0.00093939 0.00077321 0.00088682
  0.00084575 0.00078102]
 [0.00505767 0.0053334  0.00582732 0.0058591  0.00567029 0.00496274
  0.00454179 0.00577185 0.00471858 0.00424805 0.00606361 0.0049672
  0.00608815 0.00465704 0.00438708 0.00606202 0.00612092 0.00560503
  0.00607883 0.00572552]
 [0.00312803 0.00295078 0.00442152 0.00467944 0.00393238 0.00351978
  0.00417542 0.00414317 0.00374817 0.00376118 0.00469048 0.00395391
  0.00270143 0.00405709 0.00409529 0.0039148  0.00316609 0.00357475
  0.00456841 0.00415008]
 [0.00192274 0.00254764 0.00225331 0.00268574 0.00169182 0.002078
  0.00234898 0.0020522  0.00153815 0.00195633 0.00221069 0.00233468
  0.00194826 0.00279986 0.00254221 0.00264007 0.00252948 0.00245646
  0.00174386 0.00198523]
 [0.00285257 0.00263617 0.00324647 0.00385172 0.00371122 0.0027936
  0.00316689 0.00361643 0.00383464 0.00360995 0.00389994 0.00331326
  0.00318853 0.00355391 0.00364035 0.00341695 0.00310865 0.00287662
  0.00435409 0.00337117]
 [0.00432805 0.00484332 0.00443312 0.00344518 0.00396802 0.00329342
  0.00375245 0.00380529 0.00292716 0.00361407 0.00437908 0.00323364
  0.00428005 0.00381255 0.00367963 0.00418425 0.00391019 0.00436053
  0.00421686 0.00458505]
 [0.00293625 0.00381403 0.00362987 0.00335983 0.00330851 0.00322672
  0.00337212 0.00393379 0.00327914 0.00337182 0.00445399 0.00382592
  0.00324971 0.00420592 0.00377982 0.00384378 0.00358133 0.00362191
  0.00355635 0.00331627]
 [0.00184038 0.00191321 0.00268807 0.00303628 0.00272686 0.00279429
  0.00237473 0.00266722 0.00247504 0.00169244 0.00413512 0.00381664
  0.00238939 0.00227075 0.00262499 0.00321638 0.00223781 0.00238809
  0.00293717 0.00359303]
 [0.00359291 0.00406493 0.00293388 0.00266938 0.00318593 0.00335526
  0.00196986 0.00210991 0.0022524  0.0023863  0.00390822 0.00202732
  0.00334247 0.00253042 0.00246891 0.00161527 0.00353331 0.00225264
  0.00308009 0.0024969 ]
 [0.00467813 0.00520213 0.00463395 0.00468349 0.00414649 0.0042226
  0.00305573 0.00438606 0.00368354 0.00414403 0.00528803 0.00389615
  0.0043789  0.00459333 0.00445373 0.00440552 0.0042062  0.00456284
  0.00420326 0.00419123]
 [0.00350357 0.00409812 0.00397937 0.00437033 0.00321106 0.00364159
  0.00314468 0.00339632 0.00355351 0.00413611 0.00464849 0.00319542
  0.003944   0.00448411 0.00461001 0.00434811 0.00405233 0.00450855
  0.00425758 0.00441172]
 [0.00353968 0.00401753 0.00390188 0.00412258 0.00353689 0.00376455
  0.00347508 0.00357056 0.00344201 0.00335489 0.00403322 0.00329739
  0.00351046 0.00372506 0.00376812 0.00351544 0.0038273  0.00386555
  0.00416237 0.00381653]
 [0.00480845 0.00620011 0.00546315 0.00619861 0.00534168 0.00565481
  0.00478081 0.00402863 0.00543806 0.0043546  0.00575775 0.00491379
  0.0060014  0.00666276 0.0053126  0.00613814 0.00727776 0.00617178
  0.00624593 0.00549751]
 [0.00451056 0.00523723 0.00529683 0.0051838  0.00484405 0.00509713
  0.0031895  0.00327967 0.00458238 0.00498076 0.00535022 0.00441244
  0.0048051  0.00538896 0.00536285 0.00564439 0.00518464 0.00589984
  0.00552423 0.00477627]
 [0.00359179 0.0038969  0.00337997 0.00328241 0.00285577 0.0040031
  0.00360306 0.00335226 0.00366979 0.0034724  0.00411349 0.00363622
  0.00387949 0.00325857 0.00332077 0.0035856  0.00416316 0.00362717
  0.00386725 0.00331422]
 [0.00362504 0.00477787 0.00390291 0.00396466 0.00416538 0.00356892
  0.00317314 0.00316541 0.00389976 0.00322514 0.00380146 0.00313896
  0.00352132 0.00336341 0.00346973 0.00298669 0.00435195 0.0040563
  0.00461929 0.00401143]]
[[1.12023609e-04 3.51842223e-04 3.53423811e-04 1.95725312e-04
  6.37484127e-04 2.01731119e-04 5.07957036e-04 6.24510481e-04
  2.73785388e-04 5.78615274e-04 3.51974494e-04 8.13652110e-05
  6.03789521e-04 4.91548378e-04 3.81972719e-04 3.67661286e-04
  3.76947788e-04 4.87324011e-04 4.99191361e-04 5.95406000e-04]
 [1.15163943e-03 5.19760875e-03 5.36122139e-03 3.99609875e-03
  1.07695238e-02 4.80646179e-03 9.20547574e-03 9.28340224e-03
  3.19098229e-03 8.60725696e-03 4.70104160e-03 1.71078331e-03
  1.02749974e-02 8.08057653e-03 6.88923560e-03 7.69236589e-03
  7.53696857e-03 7.45243775e-03 4.56889806e-03 9.67024751e-03]
 [9.06228579e-04 5.11699738e-03 4.78180972e-03 7.03870965e-03
  1.03149856e-02 4.02817866e-03 8.30289233e-03 8.91956658e-03
  5.96178191e-03 8.97060516e-03 6.43315141e-03 1.34229000e-03
  9.99547124e-03 8.95890371e-03 7.33064493e-03 5.41881964e-03
  7.38454860e-03 7.91355031e-03 5.28648232e-03 8.68625793e-03]
 [4.64919748e-04 4.40144074e-03 3.15777469e-03 5.56061483e-03
  8.08223069e-03 3.40045336e-03 6.84879920e-03 5.95891139e-03
  3.78043914e-03 6.97090734e-03 3.38958281e-03 8.25994760e-04
  7.39282566e-03 7.02816240e-03 3.99183976e-03 4.60814127e-03
  4.79121157e-03 6.81167155e-03 3.98530747e-03 7.22491928e-03]
 [9.78100496e-04 4.59836181e-03 4.57959838e-03 6.25167564e-03
  1.07187095e-02 3.88780888e-03 8.15368374e-03 9.08835941e-03
  5.29978736e-03 9.13805438e-03 6.07934813e-03 1.37292564e-03
  1.01869358e-02 8.95888403e-03 6.11610383e-03 6.96690923e-03
  6.93954326e-03 8.52139001e-03 4.58460048e-03 9.53748978e-03]
 [6.88662933e-04 4.74824663e-03 3.22772304e-03 6.10451522e-03
  9.11895010e-03 3.43253576e-03 7.21843014e-03 7.61676147e-03
  4.34182656e-03 7.37677086e-03 5.65884649e-03 1.28009287e-03
  8.45357361e-03 7.74845962e-03 5.57376384e-03 5.10312391e-03
  6.81684736e-03 7.65797799e-03 3.65367809e-03 7.64700692e-03]
 [6.86791269e-04 5.33309186e-03 3.45553925e-03 4.64445796e-03
  8.65997320e-03 3.83816523e-03 7.85171879e-03 7.70345347e-03
  3.27895705e-03 6.67604134e-03 3.90804111e-03 8.02721902e-04
  8.13907154e-03 6.77863963e-03 5.94249265e-03 5.46968887e-03
  6.27495987e-03 6.27937222e-03 3.76126376e-03 7.34920098e-03]
 [1.12787576e-03 8.75930735e-03 4.03905314e-03 9.48652828e-03
  1.15864385e-02 4.88204403e-03 1.02493830e-02 8.86383576e-03
  5.51601764e-03 8.44961502e-03 7.34985609e-03 1.48924361e-03
  1.09727647e-02 8.64875374e-03 7.02076868e-03 5.00261855e-03
  8.20887802e-03 8.99748692e-03 3.71342463e-03 9.47495826e-03]
 [4.16500911e-04 2.34210429e-03 2.25137637e-03 2.37509959e-03
  4.68270101e-03 2.33933621e-03 4.12512911e-03 4.21266854e-03
  1.85114911e-03 3.83034426e-03 2.34412310e-03 5.71493818e-04
  4.40489437e-03 3.50566040e-03 3.31441748e-03 3.11742011e-03
  3.40559108e-03 3.03944224e-03 2.02416852e-03 4.17283485e-03]
 [5.62549858e-04 3.39499423e-03 2.31976499e-03 2.87907852e-03
  6.61589092e-03 2.30825295e-03 5.63770692e-03 5.97073871e-03
  3.09528662e-03 5.92064276e-03 2.75083543e-03 6.78394409e-04
  5.96019809e-03 5.33459293e-03 4.79696869e-03 3.92871096e-03
  4.57973398e-03 5.37945430e-03 3.73273931e-03 5.39412857e-03]
 [7.12615311e-04 3.69357059e-03 3.15138132e-03 3.31443790e-03
  6.62740748e-03 3.45767290e-03 6.17047268e-03 6.68553111e-03
  2.75661801e-03 4.77380011e-03 3.87917308e-03 5.08468022e-04
  6.12333291e-03 4.20294474e-03 5.79512778e-03 4.52806770e-03
  5.57640016e-03 3.98567426e-03 2.76009872e-03 5.25036987e-03]
 [1.60263346e-03 1.05234968e-02 7.58483750e-03 9.66389081e-03
  2.01517626e-02 5.85137793e-03 1.64898101e-02 1.80245741e-02
  9.01353942e-03 1.75396539e-02 1.01829673e-02 1.90832999e-03
  1.88012874e-02 1.71712492e-02 1.32102156e-02 1.18747882e-02
  1.22837515e-02 1.62770591e-02 1.07755079e-02 1.65092527e-02]
 [1.16949193e-03 8.47450349e-03 6.80230611e-03 8.74915847e-03
  1.57690097e-02 7.16208020e-03 1.30837571e-02 1.47008918e-02
  7.70831947e-03 1.32773370e-02 7.93618289e-03 1.73801503e-03
  1.49076711e-02 1.28199396e-02 1.13735442e-02 1.04081401e-02
  1.22404902e-02 1.12770064e-02 6.98976740e-03 1.38924164e-02]
 [7.93682890e-04 3.67747594e-03 4.51771037e-03 4.89843490e-03
  9.07037221e-03 3.14156150e-03 7.13844200e-03 8.44071848e-03
  3.92222859e-03 7.26958552e-03 5.35158165e-03 8.78967467e-04
  8.53342905e-03 7.08541040e-03 6.12090827e-03 5.91799182e-03
  6.94270904e-03 6.80436931e-03 3.53562716e-03 7.39139986e-03]
 [5.96131628e-04 2.53772670e-03 2.63266911e-03 3.08038390e-03
  6.47136473e-03 2.57232153e-03 5.42167503e-03 6.27178869e-03
  3.27353630e-03 5.52738878e-03 3.13741120e-03 7.03621690e-04
  5.81354001e-03 4.22324921e-03 5.33022287e-03 4.54955484e-03
  5.40655561e-03 4.42992973e-03 2.16682286e-03 5.00444949e-03]
 [8.18460612e-04 4.45883592e-03 2.85091643e-03 5.59523001e-03
  8.59263706e-03 1.76733744e-03 6.50753787e-03 6.73209961e-03
  2.08788179e-03 6.07247455e-03 6.48551049e-03 9.24999244e-04
  8.14124533e-03 5.69900288e-03 2.40152569e-03 3.21050923e-03
  4.75653316e-03 6.26712050e-03 2.94130742e-03 8.18918947e-03]
 [5.09968042e-04 4.23374802e-03 2.24253430e-03 4.00618932e-03
  6.57468007e-03 2.52043617e-03 5.94044671e-03 5.09938992e-03
  2.62239015e-03 5.29978883e-03 2.93627972e-03 8.05597687e-04
  5.83909151e-03 5.52235009e-03 3.84232366e-03 3.57443938e-03
  4.09470025e-03 5.47097927e-03 3.05758679e-03 5.73855339e-03]
 [9.08021653e-04 3.02776647e-03 5.21275975e-03 3.46232045e-03
  8.62937571e-03 1.83918983e-03 6.31598329e-03 8.34308393e-03
  3.44165115e-03 7.02323087e-03 6.51518248e-03 1.09390198e-03
  8.49717771e-03 6.37982617e-03 5.68886560e-03 6.72042997e-03
  6.92998657e-03 6.20177912e-03 3.77157396e-03 7.00295610e-03]
 [5.53274261e-04 3.76247811e-03 1.90214505e-03 3.34285376e-03
  6.90718394e-03 2.23627859e-03 5.75536351e-03 5.88250081e-03
  3.44456501e-03 5.61608075e-03 3.08725491e-03 6.84567147e-04
  6.22980801e-03 5.81480425e-03 4.44766049e-03 3.79348385e-03
  4.61243429e-03 5.54474118e-03 3.44082884e-03 5.56897649e-03]
 [1.05038430e-03 3.94595052e-03 6.22747486e-03 2.86904445e-03
  1.25073276e-02 3.75236171e-03 9.57012842e-03 1.18763968e-02
  4.82252589e-03 1.09323592e-02 6.07844164e-03 1.09241067e-03
  1.17083588e-02 1.01317176e-02 8.80533032e-03 8.58697240e-03
  8.83139667e-03 9.16684725e-03 6.20833643e-03 1.02678493e-02]]
[[4.56040606e-04 4.21157122e-03 1.13748562e-02 6.39549459e-03
  1.30157569e-02 1.96635044e-02 2.19400653e-02 2.55868713e-02
  8.06509614e-03 1.82041204e-02 2.70016809e-02 1.45463795e-02
  1.45902375e-02 1.88186462e-02 6.57503233e-03 2.72552419e-02
  1.94148371e-02 2.47403797e-02 2.72868850e-02 2.27079773e-02]
 [3.63347294e-05 6.31735854e-04 5.47839250e-04 3.22277823e-04
  1.45614857e-03 2.66675670e-03 2.44976160e-03 3.00882744e-03
  9.85999792e-04 2.49197578e-03 3.03993366e-03 8.40874103e-04
  1.34294412e-03 1.25560904e-03 1.75674848e-03 3.14667696e-03
  1.96650737e-03 2.86987829e-03 3.04976782e-03 1.80728502e-03]
 [1.06174252e-04 2.39210569e-03 2.73112587e-03 1.50508184e-03
  3.79856533e-03 6.10248293e-03 6.55290414e-03 7.43531769e-03
  3.15970472e-03 6.44109182e-03 8.19250615e-03 2.18868217e-03
  3.67412537e-03 4.19081718e-03 3.34340316e-03 8.21168069e-03
  4.83052024e-03 8.12812785e-03 8.43139901e-03 7.33238199e-03]
 [5.62309837e-05 1.48216919e-03 1.29921663e-03 7.74748113e-04
  1.94808385e-03 5.23978458e-03 5.00254934e-03 6.37130930e-03
  2.01109798e-03 5.22258461e-03 6.65523353e-03 1.59625033e-03
  2.83994970e-03 2.90632143e-03 2.74490678e-03 6.68575458e-03
  4.27576910e-03 6.48689636e-03 6.52486830e-03 5.12630406e-03]
 [4.25090361e-04 8.84900949e-03 2.07906311e-02 1.26799152e-02
  2.42288497e-02 3.26463924e-02 2.79846402e-02 3.82074096e-02
  1.10719474e-02 2.73425761e-02 4.01139278e-02 9.77970325e-03
  1.59600243e-02 2.51878154e-02 1.06229177e-02 4.01835679e-02
  1.91279685e-02 4.06961640e-02 4.19406680e-02 3.76246865e-02]
 [2.01431709e-04 3.04476194e-03 8.14553959e-03 4.54427588e-03
  8.01143982e-03 9.17674232e-03 1.19421239e-02 1.28362309e-02
  3.84401403e-03 1.30199477e-02 1.53158133e-02 4.67054425e-03
  7.57176778e-03 1.07505614e-02 5.39209028e-03 1.51113728e-02
  1.11350891e-02 1.55931567e-02 1.52204038e-02 1.43052735e-02]
 [5.58218432e-04 5.14343413e-03 1.42138478e-02 5.72057406e-03
  1.74232947e-02 3.19073848e-02 2.24266979e-02 3.01376203e-02
  1.32850823e-02 2.44267873e-02 3.27323818e-02 1.05121792e-02
  1.70883734e-02 1.51957887e-02 9.99006211e-03 3.48904575e-02
  2.12902623e-02 3.18209815e-02 3.54873927e-02 3.15780488e-02]
 [3.89619809e-04 5.54483743e-03 1.95167414e-02 8.72451579e-03
  2.01879800e-02 2.03391758e-02 2.36560301e-02 2.40374765e-02
  9.84224971e-03 2.58864880e-02 3.24707167e-02 1.14822338e-02
  1.70120177e-02 2.31450785e-02 5.12760964e-03 2.95762725e-02
  1.78495203e-02 3.03166266e-02 3.20570896e-02 3.06860072e-02]
 [5.09656319e-04 4.90580947e-03 1.03739631e-02 6.90579041e-03
  1.02403493e-02 2.39014974e-02 2.46821669e-02 2.60549900e-02
  1.08878668e-02 1.97914135e-02 2.94491683e-02 1.06089646e-02
  1.77692813e-02 1.72945952e-02 8.81737547e-03 3.00049917e-02
  2.28818002e-02 2.87142532e-02 2.95432521e-02 2.72569140e-02]
 [1.01277334e-04 1.63708863e-03 1.52883580e-03 7.57913012e-04
  3.54576818e-03 5.70580131e-03 4.73519014e-03 5.74091046e-03
  2.92546572e-03 3.69500078e-03 5.49098925e-03 2.06469620e-03
  2.41328575e-03 2.03155704e-03 3.33350690e-03 6.07954070e-03
  3.10827083e-03 5.64959759e-03 6.16626198e-03 4.38798789e-03]]
181
[[1.e-08 1.e-08 1.e-08 ... 1.e-08 1.e-08 1.e-08]
 [1.e-08 1.e-08 1.e-08 ... 1.e-08 1.e-08 1.e-08]
 [1.e-08 1.e-08 1.e-08 ... 1.e-08 1.e-08 1.e-08]
 ...
 [1.e-08 1.e-08 1.e-08 ... 1.e-08 1.e-08 1.e-08]
 [1.e-08 1.e-08 1.e-08 ... 1.e-08 1.e-08 1.e-08]
 [1.e-08 1.e-08 1.e-08 ... 1.e-08 1.e-08 1.e-08]]
C:\Users\shrey\Desktop\ACAD\DL\DA6401_AS1\T3.py:280: RuntimeWarning: overflow encountered in divide
  weights[j] -= learning_rate*((m_W_hat + weight_decay*weights[j])/(np.sqrt(v_W_hat) + epsilon))
[[0.00211361 0.00186735 0.00203577 0.00170212 0.00198832 0.00184631
  0.00101848 0.00069871 0.0008235  0.00123531 0.00200024 0.00069889
  0.00178233 0.00154196 0.00167668 0.00078128 0.00188721 0.00179201
  0.001313   0.00152545]
 [0.00402115 0.00501126 0.00442892 0.00489363 0.00431176 0.00473269
  0.00490381 0.00502729 0.00450446 0.00457039 0.00560881 0.00424472
  0.00528735 0.00374444 0.00467417 0.00459458 0.00513959 0.00493526
  0.00550138 0.00517549]
 [0.00364764 0.00416656 0.00501609 0.00389021 0.0036626  0.00329179
  0.00285054 0.0032479  0.00324586 0.00420402 0.00449932 0.00382647
  0.00378578 0.00456858 0.00414354 0.00470447 0.00381882 0.00441161
  0.00410941 0.00459552]
 [0.00323282 0.00311385 0.00373555 0.00345088 0.00328813 0.00317889
  0.00218125 0.00304732 0.00353719 0.00295985 0.00381994 0.0029032
  0.00349403 0.00336349 0.00356118 0.00283733 0.00328671 0.00335122
  0.00378068 0.00341736]
 [0.00051886 0.00097092 0.00107671 0.0008238  0.00090288 0.00057968
  0.00053825 0.00071544 0.00071007 0.00059239 0.00108902 0.0008259
  0.0006294  0.00074751 0.00048822 0.00093965 0.00077256 0.00088754
  0.0008434  0.00077866]
 [0.00504282 0.00532365 0.0058113  0.005845   0.00566892 0.00494934
  0.00453064 0.00576898 0.0047045  0.00424747 0.00605663 0.00495347
  0.00607737 0.0046517  0.00437449 0.00604453 0.00611145 0.00559549
  0.00606687 0.00571632]
 [0.00311879 0.00294193 0.00440832 0.00466531 0.00392075 0.00350942
  0.00416287 0.00413208 0.0037375  0.00375168 0.00467679 0.00394227
  0.00269326 0.00404498 0.00408299 0.00390299 0.00315667 0.00356535
  0.0045546  0.0041385 ]
 [0.00191699 0.00254081 0.00224689 0.00267976 0.00169394 0.00208084
  0.00234588 0.0020472  0.00154544 0.00195093 0.00220449 0.00232799
  0.00194427 0.00279501 0.00253754 0.00263293 0.00252363 0.00245505
  0.00174088 0.00198033]
 [0.00284561 0.0026282  0.00323691 0.00384601 0.0037     0.00278723
  0.00316077 0.00360551 0.00382474 0.00360017 0.00388954 0.0033033
  0.00317892 0.00354444 0.00363519 0.00340824 0.00310223 0.00286907
  0.00434148 0.00336205]
 [0.00431682 0.00482966 0.00442194 0.00343859 0.00396264 0.00328834
  0.00374115 0.0037996  0.00291851 0.00360526 0.00436811 0.00322386
  0.00426824 0.00380249 0.00366948 0.00417645 0.0039061  0.00435361
  0.00420587 0.00457205]
 [0.00292771 0.00380347 0.00362095 0.00336431 0.00329864 0.00321983
  0.00336209 0.00397126 0.00327978 0.00337503 0.00446986 0.00381797
  0.00324121 0.00419658 0.0037691  0.00383422 0.00357052 0.00365244
  0.00355904 0.0033087 ]
 [0.00184548 0.00191191 0.00268013 0.00302717 0.00271872 0.00278941
  0.00237051 0.00265964 0.00247216 0.00169055 0.00412913 0.00380511
  0.00238285 0.0022639  0.00261722 0.00320709 0.00223121 0.00238496
  0.00292899 0.00359085]
 [0.00358755 0.00405398 0.00292997 0.00266212 0.0031763  0.00335772
  0.00196417 0.0021037  0.00224597 0.00238072 0.00389965 0.00202126
  0.00333434 0.0025237  0.00246457 0.00162187 0.00352367 0.00224592
  0.00307215 0.00249429]
 [0.00466841 0.00518663 0.00462043 0.00467242 0.00413405 0.00421205
  0.00304804 0.00437689 0.00367249 0.00413162 0.00527465 0.00388443
  0.00436644 0.00458348 0.00444211 0.0043929  0.00419349 0.00454976
  0.0041947  0.00418035]
 [0.00349309 0.00409473 0.00396799 0.0043595  0.00320706 0.00363064
  0.00313838 0.00338613 0.00355392 0.00412384 0.00463494 0.00319017
  0.00393284 0.00447254 0.00459758 0.00433728 0.00404791 0.00449493
  0.00424598 0.00439929]
 [0.00353536 0.00400953 0.00389946 0.00412327 0.00356065 0.00375551
  0.00346457 0.00358961 0.00345946 0.00338775 0.00403678 0.00330384
  0.00352718 0.00374144 0.00376387 0.00351853 0.00382937 0.00386419
  0.00415478 0.00383634]
 [0.00479564 0.00619121 0.00544846 0.00622323 0.00533035 0.00565941
  0.00479607 0.00402761 0.00546406 0.00434216 0.00574368 0.00490084
  0.00601254 0.00664262 0.00532829 0.00612154 0.00727    0.00620233
  0.00626345 0.00548867]
 [0.00450022 0.00522562 0.00528743 0.00517287 0.00484175 0.00508252
  0.00318139 0.00328834 0.00457609 0.00498259 0.00534498 0.00440773
  0.00480263 0.00537752 0.00534696 0.00563759 0.00517254 0.0058879
  0.0055141  0.00476972]
 [0.00358777 0.00390043 0.00337022 0.00327275 0.00285079 0.00400621
  0.00359715 0.00334433 0.00366051 0.00346226 0.0041015  0.00362528
  0.00387458 0.00324879 0.00331117 0.00357642 0.00415654 0.00361625
  0.00385821 0.003319  ]
 [0.00361584 0.00476349 0.00389336 0.00395341 0.00416024 0.00355901
  0.00316411 0.00315678 0.00388911 0.00321783 0.00379    0.0031318
  0.00351138 0.00335801 0.00345925 0.00298152 0.00433988 0.00404495
  0.00460651 0.00400486]]
[[1.11689192e-04 3.50841307e-04 3.52367222e-04 1.95185753e-04
  6.35631373e-04 2.01245729e-04 5.06430426e-04 6.22669897e-04
  2.72960664e-04 5.76970687e-04 3.50954334e-04 8.11192640e-05
  6.02067990e-04 4.90263199e-04 3.80817992e-04 3.66610057e-04
  3.75838961e-04 4.85912466e-04 4.97703329e-04 5.93660012e-04]
 [1.14857117e-03 5.18573818e-03 5.34886331e-03 3.98727143e-03
  1.07397189e-02 4.79293434e-03 9.18647250e-03 9.26296751e-03
  3.18193511e-03 8.58148353e-03 4.68691598e-03 1.70580388e-03
  1.02452121e-02 8.05673132e-03 6.88580598e-03 7.67031031e-03
  7.51875346e-03 7.42992787e-03 4.55666529e-03 9.64239089e-03]
 [9.03516851e-04 5.10154906e-03 4.76736870e-03 7.01837298e-03
  1.02880323e-02 4.01651562e-03 8.27979760e-03 8.89454871e-03
  5.94585259e-03 8.94915165e-03 6.41600500e-03 1.33826677e-03
  9.96930833e-03 8.93862318e-03 7.30951781e-03 5.40749257e-03
  7.36425049e-03 7.89567389e-03 5.27052630e-03 8.66133840e-03]
 [4.63610230e-04 4.39237715e-03 3.14837975e-03 5.55190351e-03
  8.09302704e-03 3.39485249e-03 6.84584664e-03 5.97013918e-03
  3.79569798e-03 6.99549806e-03 3.38596599e-03 8.23676829e-04
  7.39987903e-03 7.04461213e-03 4.00012348e-03 4.62223763e-03
  4.79768117e-03 6.82610984e-03 3.97861656e-03 7.23320612e-03]
 [9.75144550e-04 4.58575355e-03 4.56576530e-03 6.23713105e-03
  1.07048752e-02 3.88105783e-03 8.12977639e-03 9.07284652e-03
  5.30028389e-03 9.13951809e-03 6.06673474e-03 1.36877516e-03
  1.01752725e-02 8.95843144e-03 6.09797941e-03 6.95954515e-03
  6.92707185e-03 8.51831951e-03 4.57081683e-03 9.53207571e-03]
 [6.86707773e-04 4.73427430e-03 3.21995724e-03 6.10540292e-03
  9.11694459e-03 3.44582571e-03 7.20235577e-03 7.61574570e-03
  4.35499912e-03 7.37071191e-03 5.64946547e-03 1.27684039e-03
  8.45704648e-03 7.73555211e-03 5.56532198e-03 5.09572928e-03
  6.80953113e-03 7.65748148e-03 3.64263389e-03 7.65754592e-03]
 [6.84715037e-04 5.31710928e-03 3.44521659e-03 4.63067982e-03
  8.63412592e-03 3.82668520e-03 7.82800646e-03 7.68020096e-03
  3.27013454e-03 6.65589188e-03 3.90111273e-03 8.00337232e-04
  8.11500486e-03 6.76036255e-03 5.92476518e-03 5.45372976e-03
  6.25629601e-03 6.26134162e-03 3.75326491e-03 7.32737588e-03]
 [1.12447502e-03 8.73297173e-03 4.02695782e-03 9.45810854e-03
  1.15517148e-02 4.86791503e-03 1.02183975e-02 8.83713041e-03
  5.49934571e-03 8.42512877e-03 7.33350763e-03 1.48483865e-03
  1.09397886e-02 8.62475749e-03 6.99971898e-03 4.99078312e-03
  8.18442632e-03 8.97208645e-03 3.70579284e-03 9.44866696e-03]
 [4.15359732e-04 2.33572170e-03 2.24478069e-03 2.36794448e-03
  4.66982882e-03 2.33231409e-03 4.11413114e-03 4.20095997e-03
  1.84611935e-03 3.82198321e-03 2.33707861e-03 5.69828580e-04
  4.39243578e-03 3.50015885e-03 3.30441931e-03 3.11103041e-03
  3.39571048e-03 3.03092174e-03 2.01808199e-03 4.16145754e-03]
 [5.61325935e-04 3.38646450e-03 2.32878683e-03 2.89297521e-03
  6.60692035e-03 2.32876861e-03 5.63171411e-03 5.97200080e-03
  3.08699496e-03 5.90281504e-03 2.75006278e-03 6.78283754e-04
  5.95504507e-03 5.31883830e-03 4.80139390e-03 3.91809226e-03
  4.57929529e-03 5.36501988e-03 3.72233242e-03 5.38931783e-03]
 [7.10523937e-04 3.68499356e-03 3.14194235e-03 3.30610352e-03
  6.61077661e-03 3.44739797e-03 6.15543696e-03 6.66697582e-03
  2.74841018e-03 4.76287659e-03 3.86979600e-03 5.06930878e-04
  6.10698231e-03 4.19653846e-03 5.78012469e-03 4.51788394e-03
  5.56158882e-03 3.97793024e-03 2.75184248e-03 5.23473175e-03]
 [1.59859214e-03 1.04931868e-02 7.56817022e-03 9.65278811e-03
  2.01065776e-02 5.84657317e-03 1.64458763e-02 1.79812282e-02
  8.98629159e-03 1.74953152e-02 1.01844334e-02 1.90284329e-03
  1.87573018e-02 1.71316576e-02 1.31733229e-02 1.18550013e-02
  1.22641074e-02 1.62417009e-02 1.07480131e-02 1.64639752e-02]
 [1.16602371e-03 8.44891930e-03 6.78175118e-03 8.72899203e-03
  1.57307172e-02 7.14648594e-03 1.30466786e-02 1.46588318e-02
  7.69031683e-03 1.32464108e-02 7.92093680e-03 1.73316770e-03
  1.48725781e-02 1.28037887e-02 1.13394277e-02 1.03828517e-02
  1.22064252e-02 1.12596095e-02 6.97175993e-03 1.38536232e-02]
 [7.91290214e-04 3.67706939e-03 4.50407352e-03 4.88601610e-03
  9.06273580e-03 3.13272824e-03 7.12526611e-03 8.42836013e-03
  3.93239367e-03 7.27367324e-03 5.33716974e-03 8.76312633e-04
  8.52657767e-03 7.08951144e-03 6.11025157e-03 5.91113843e-03
  6.92931038e-03 6.80613557e-03 3.53095507e-03 7.38696474e-03]
 [5.95658169e-04 2.56275760e-03 2.62955529e-03 3.10214473e-03
  6.50450383e-03 2.58370473e-03 5.44855990e-03 6.30818286e-03
  3.30265430e-03 5.53682753e-03 3.13896493e-03 7.03436611e-04
  5.84233794e-03 4.23726172e-03 5.35936012e-03 4.55013876e-03
  5.42196422e-03 4.46307074e-03 2.17136544e-03 5.04354026e-03]
 [8.16013820e-04 4.44539723e-03 2.84254001e-03 5.57917001e-03
  8.57289468e-03 1.76732683e-03 6.48885564e-03 6.71562783e-03
  2.08673857e-03 6.06662939e-03 6.46614708e-03 9.22203635e-04
  8.12371155e-03 5.69451900e-03 2.39495426e-03 3.20844243e-03
  4.74563715e-03 6.25599946e-03 2.93330293e-03 8.17145871e-03]
 [5.09036641e-04 4.22627740e-03 2.24003198e-03 3.99622319e-03
  6.57930882e-03 2.51566401e-03 5.94199728e-03 5.10316079e-03
  2.61564541e-03 5.33613945e-03 2.92742580e-03 8.03534061e-04
  5.84577376e-03 5.56984256e-03 3.84454355e-03 3.59763133e-03
  4.09254623e-03 5.47274383e-03 3.05299358e-03 5.73228337e-03]
 [9.05280296e-04 3.01883953e-03 5.19719551e-03 3.45209947e-03
  8.60483402e-03 1.83377155e-03 6.29771277e-03 8.31898582e-03
  3.43253630e-03 7.00475698e-03 6.49549788e-03 1.09059657e-03
  8.47308102e-03 6.36188929e-03 5.67299705e-03 6.70119190e-03
  6.90975557e-03 6.18434804e-03 3.76123856e-03 6.98320883e-03]
 [5.51715852e-04 3.75154729e-03 1.89654186e-03 3.33495132e-03
  6.89210749e-03 2.23017145e-03 5.73809013e-03 5.86684217e-03
  3.43588515e-03 5.60915239e-03 3.08008083e-03 6.82895815e-04
  6.21995034e-03 5.81552673e-03 4.43425154e-03 3.78856081e-03
  4.59968268e-03 5.53609776e-03 3.43059268e-03 5.55485255e-03]
 [1.04724909e-03 3.95214346e-03 6.20930701e-03 2.87613624e-03
  1.24825794e-02 3.74380376e-03 9.55670834e-03 1.18496025e-02
  4.81711278e-03 1.09090522e-02 6.06285874e-03 1.08911587e-03
  1.16846956e-02 1.01202043e-02 8.78849026e-03 8.56713846e-03
  8.81108125e-03 9.15484621e-03 6.19102718e-03 1.02408227e-02]]
[[4.54664167e-04 4.19884296e-03 1.13405554e-02 6.37781545e-03
  1.29768271e-02 1.96047292e-02 2.18797597e-02 2.55151782e-02
  8.04120275e-03 1.81497817e-02 2.69242559e-02 1.45034516e-02
  1.45462312e-02 1.87645577e-02 6.56893894e-03 2.71775758e-02
  1.93622881e-02 2.46706907e-02 2.72077892e-02 2.26437455e-02]
 [3.76962263e-05 6.45455410e-04 5.50665515e-04 3.40712685e-04
  1.51020188e-03 2.76230941e-03 2.53535174e-03 3.11074869e-03
  1.00940473e-03 2.59310945e-03 3.13709522e-03 8.53681119e-04
  1.41032842e-03 1.30683477e-03 1.84140999e-03 3.24483826e-03
  2.00111623e-03 2.96642746e-03 3.14205500e-03 1.84460091e-03]
 [1.06540578e-04 2.41349417e-03 2.83708851e-03 1.53793664e-03
  3.80134778e-03 6.26891491e-03 6.72242034e-03 7.69615776e-03
  3.20177132e-03 6.60954113e-03 8.37844392e-03 2.23445700e-03
  3.70539873e-03 4.26155070e-03 3.51262534e-03 8.50808546e-03
  4.94081159e-03 8.41065909e-03 8.70933507e-03 7.55501766e-03]
 [5.61300320e-05 1.47794953e-03 1.29968704e-03 7.88052622e-04
  1.94672284e-03 5.23977292e-03 5.02394253e-03 6.37644567e-03
  2.00850128e-03 5.24950363e-03 6.66852396e-03 1.59533063e-03
  2.85787676e-03 2.92808287e-03 2.74067810e-03 6.69703304e-03
  4.28331031e-03 6.50054216e-03 6.53262431e-03 5.14728151e-03]
 [4.23875826e-04 8.82226031e-03 2.07281878e-02 1.26416180e-02
  2.41560143e-02 3.25478025e-02 2.79000400e-02 3.80931286e-02
  1.10384849e-02 2.72684775e-02 3.99946768e-02 9.75651837e-03
  1.59130621e-02 2.51128208e-02 1.05955002e-02 4.00631342e-02
  1.90713596e-02 4.05743058e-02 4.18148524e-02 3.75130491e-02]
 [2.00862035e-04 3.04104090e-03 8.12219808e-03 4.53864047e-03
  7.98737590e-03 9.15476856e-03 1.19488089e-02 1.28829110e-02
  3.83255777e-03 1.30061653e-02 1.53044651e-02 4.67499880e-03
  7.57100856e-03 1.07457067e-02 5.39059565e-03 1.50994583e-02
  1.11241873e-02 1.55740565e-02 1.51998201e-02 1.42754755e-02]
 [5.56710145e-04 5.13322570e-03 1.41838052e-02 5.70926320e-03
  1.73823760e-02 3.18408621e-02 2.23948050e-02 3.00836723e-02
  1.32531354e-02 2.44040101e-02 3.26809382e-02 1.04872428e-02
  1.70486886e-02 1.51686011e-02 9.99235408e-03 3.48382138e-02
  2.12545401e-02 3.17874010e-02 3.54320752e-02 3.15331894e-02]
 [3.89005963e-04 5.53254853e-03 1.94586897e-02 8.70108503e-03
  2.01287291e-02 2.02851136e-02 2.36214988e-02 2.39926000e-02
  9.81614598e-03 2.58181391e-02 3.23952169e-02 1.14499427e-02
  1.69961222e-02 2.30885449e-02 5.11488733e-03 2.95015552e-02
  1.78279365e-02 3.02402132e-02 3.19719779e-02 3.06048804e-02]
 [5.08576126e-04 4.89956148e-03 1.03462429e-02 6.90057493e-03
  1.02214177e-02 2.38797349e-02 2.47235832e-02 2.60939939e-02
  1.08681758e-02 1.98559927e-02 2.94815324e-02 1.06080944e-02
  1.77814668e-02 1.73075086e-02 8.83094956e-03 3.00292896e-02
  2.29016519e-02 2.87437045e-02 2.95579598e-02 2.72704297e-02]
 [1.00971348e-04 1.63304064e-03 1.52473747e-03 7.55710314e-04
  3.53512859e-03 5.68868107e-03 4.72093179e-03 5.72355742e-03
  2.91699030e-03 3.68468065e-03 5.47450000e-03 2.06049994e-03
  2.40599026e-03 2.02574646e-03 3.32393334e-03 6.06128557e-03
  3.10166048e-03 5.63273070e-03 6.14765500e-03 4.37559099e-03]]
182
C:\Users\shrey\Desktop\ACAD\DL\DA6401_AS1\T3.py:59: RuntimeWarning: invalid value encountered in matmul
  x = bias[layer] + ( weights[layer] @ x )
C:\Users\shrey\Desktop\ACAD\DL\DA6401_AS1\T3.py:280: RuntimeWarning: invalid value encountered in subtract
  weights[j] -= learning_rate*((m_W_hat + weight_decay*weights[j])/(np.sqrt(v_W_hat) + epsilon))
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
