1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
[[0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 3.16726673e-04
  4.64337577e-05 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 9.57591639e-12
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 1.85368893e-13
  1.45044520e-40 0.00000000e+00]
 ...
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 9.35837816e-06
  9.30992822e-16 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 7.87397883e-05
  7.27691703e-07 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 7.78354014e-10
  1.74811233e-10 0.00000000e+00]]
[[3.67889138e-03 2.59657350e-03 4.09081562e-03 3.61322599e-03
  3.14554594e-03 2.62126653e-03 4.32572771e-03 3.10607228e-03
  1.83917105e-03 3.75559362e-03 3.45563789e-03 1.86337219e-03
  3.59956301e-03 3.22962475e-03 3.08582274e-03 2.45235697e-03
  2.25507175e-03 2.51108445e-03 2.46055154e-03 3.51452611e-03]
 [4.36754273e-03 4.23238462e-03 4.76298073e-03 1.32342539e-09
  3.63158527e-03 4.30953350e-03 4.93245854e-03 3.68484716e-03
  3.99208270e-03 4.55328408e-03 4.44002086e-03 2.14432887e-03
  4.49021476e-03 3.18303761e-03 3.66920853e-03 3.97682430e-03
  3.48177518e-03 3.97392390e-03 2.90657602e-03 3.62784518e-03]
 [3.81359984e-03 2.75140445e-03 4.29576749e-03 5.23131284e-03
  3.21236698e-03 3.10620363e-03 5.44198901e-03 3.66125530e-03
  1.82503375e-03 4.60158943e-03 4.53923312e-03 2.29212431e-03
  4.33801595e-03 3.19973676e-03 3.07724101e-03 2.92777145e-03
  2.75136480e-03 3.61515707e-03 3.85320735e-03 4.45755237e-03]
 [6.31416703e-03 7.60460604e-03 7.04869744e-03 4.73202773e-03
  8.17043220e-03 7.78108704e-03 7.06011431e-03 6.91431997e-03
  7.85205021e-03 6.45359090e-03 7.73149495e-03 6.56172361e-03
  6.59382074e-03 7.00037763e-03 6.28964283e-03 7.05231432e-03
  7.51190310e-03 5.83530631e-03 4.85331209e-03 6.67052646e-03]
 [2.05895666e-03 2.03094871e-03 2.30020293e-03 2.64834730e-09
  1.87895515e-03 1.61985661e-03 1.28884868e-03 1.24278999e-03
  1.99821260e-03 1.17260646e-03 2.17114820e-03 1.19604394e-03
  1.50069616e-03 1.38865223e-03 1.85744585e-03 2.03492752e-03
  2.14792345e-03 1.31724745e-03 9.32805353e-04 1.53402208e-03]
 [3.39007885e-03 4.58967960e-03 4.49075248e-03 1.37449190e-03
  4.34923752e-03 5.34023184e-03 2.50934912e-03 3.60811460e-03
  4.81570053e-03 2.15371687e-03 4.40868550e-03 3.54733043e-03
  4.08062507e-03 2.41000344e-03 3.43993747e-03 4.76246434e-03
  4.81391484e-03 2.88167096e-03 2.36955403e-03 4.52057219e-03]
 [6.07286668e-03 5.82090710e-03 5.51401167e-03 5.39837209e-03
  6.13047558e-03 5.98980489e-03 5.15341914e-03 5.70395824e-03
  5.55729730e-03 4.69018134e-03 6.19036083e-03 4.91030758e-03
  6.05626929e-03 5.53680128e-03 5.28228789e-03 5.48064292e-03
  6.09318696e-03 4.48727643e-03 4.61796902e-03 5.71108196e-03]
 [2.16590909e-03 2.66723031e-03 2.54898948e-03 1.06898058e-03
  2.51160911e-03 2.61737592e-03 2.43949932e-03 1.91810775e-03
  2.66970401e-03 2.03169185e-03 2.44668424e-03 2.02367542e-03
  2.33117172e-03 2.26772185e-03 2.22877151e-03 2.56826353e-03
  2.36574572e-03 1.98212136e-03 1.74373965e-03 2.21533151e-03]
 [5.49577460e-03 5.20117661e-03 4.72390885e-03 5.06760505e-03
  4.74279956e-03 4.26578365e-03 4.10044513e-03 4.66568259e-03
  4.23959926e-03 4.33724533e-03 4.53153836e-03 3.78352524e-03
  5.43334675e-03 5.22879087e-03 4.20481803e-03 4.15893073e-03
  4.78725674e-03 2.50660108e-03 4.36870851e-03 5.24504316e-03]
 [1.20333686e-03 1.22313188e-03 1.69797559e-03 2.90560460e-11
  1.16028451e-03 1.16277556e-03 1.88846923e-03 1.40329523e-03
  8.49565522e-04 1.73630950e-03 1.30279391e-03 9.80950356e-04
  1.29959929e-03 1.24261532e-03 6.55260017e-04 7.76321292e-04
  1.13707655e-03 9.99775150e-04 1.09954357e-03 1.56322129e-03]
 [2.36590117e-03 2.47615518e-03 2.10670896e-03 9.32844373e-04
  2.14926945e-03 2.76703700e-03 1.63506673e-03 2.33703212e-03
  2.65543028e-03 1.67936745e-03 2.19732473e-03 2.10161385e-03
  1.87502383e-03 1.61385619e-03 2.24340151e-03 2.34081962e-03
  2.63566151e-03 2.08510569e-03 1.53319313e-03 2.33965177e-03]
 [5.13805229e-03 5.54503176e-03 5.37487926e-03 6.16465552e-03
  5.67683211e-03 5.26826391e-03 6.10230821e-03 5.40313842e-03
  5.15591843e-03 5.74946205e-03 5.99316205e-03 4.47441938e-03
  5.48580265e-03 5.52102072e-03 4.95210842e-03 5.57419412e-03
  6.18753199e-03 3.78569112e-03 4.77712296e-03 6.30914958e-03]
 [4.38046367e-03 3.74620358e-03 4.12043470e-03 4.44611932e-03
  4.61817531e-03 4.55882846e-03 4.18162432e-03 4.11558748e-03
  3.96499228e-03 3.86899642e-03 4.36882384e-03 3.62278215e-03
  3.28183398e-03 3.53702081e-03 3.25630714e-03 4.00205822e-03
  4.17337590e-03 3.33228374e-03 3.22813083e-03 4.16425122e-03]
 [3.71623580e-03 3.67222847e-03 4.31568682e-03 3.67902979e-03
  3.40363377e-03 3.26154375e-03 4.70806259e-03 3.47019162e-03
  3.11438297e-03 4.75554706e-03 4.16126227e-03 1.95592044e-03
  3.91447887e-03 3.75663101e-03 2.81851799e-03 3.37801985e-03
  3.08234102e-03 3.43176860e-03 3.09350632e-03 4.19759810e-03]
 [6.60053571e-03 5.66478750e-03 5.72812713e-03 6.97990837e-03
  6.70509417e-03 5.66915723e-03 5.73793991e-03 6.14866679e-03
  5.51072920e-03 5.52943133e-03 5.33686618e-03 4.43112020e-03
  6.38635613e-03 6.41030451e-03 5.35468793e-03 5.61033451e-03
  6.98330178e-03 4.64072686e-03 4.51284621e-03 6.22784515e-03]
 [3.43844831e-03 3.30859899e-03 3.89062953e-03 4.16974984e-03
  3.83279113e-03 3.48392900e-03 3.69725589e-03 3.14366022e-03
  3.30675153e-03 3.58165313e-03 3.66869040e-03 2.25304200e-03
  3.71988916e-03 3.41517285e-03 2.98843672e-03 3.27644015e-03
  3.34741184e-03 2.91103645e-03 2.98807492e-03 3.76341938e-03]
 [4.95049794e-03 4.07730290e-03 5.38232410e-03 1.12393326e-03
  4.38422640e-03 3.98882129e-03 6.07760901e-03 3.86535337e-03
  3.74795940e-03 4.70573009e-03 4.66613376e-03 3.34451967e-03
  4.30379807e-03 4.79281601e-03 4.09326251e-03 4.08321259e-03
  3.13528261e-03 2.87438078e-03 3.19703431e-03 3.87847554e-03]
 [3.14224723e-03 2.33335135e-03 3.19460911e-03 3.60871991e-03
  2.92976506e-03 2.05684969e-03 3.65134200e-03 2.79019254e-03
  1.09212113e-03 3.56461631e-03 2.90860474e-03 1.87522605e-03
  2.86113356e-03 2.97803314e-03 2.13383483e-03 1.48411118e-03
  2.44298461e-03 1.46255070e-03 2.34186622e-03 3.24256245e-03]
 [1.58535241e-02 1.79345622e-02 1.41467590e-02 1.19296843e-02
  1.93876341e-02 1.83467721e-02 1.44389672e-02 1.74039445e-02
  1.90054861e-02 1.30701168e-02 1.68991929e-02 1.46461955e-02
  1.40840156e-02 1.70194650e-02 1.78191588e-02 1.97715085e-02
  1.91843500e-02 1.18302260e-02 1.10564282e-02 1.60182089e-02]
 [1.43379008e-03 1.82463644e-03 1.89567308e-03 2.47404042e-09
  1.57861733e-03 1.82328708e-03 1.25079549e-03 7.39676385e-04
  1.82973068e-03 1.14459056e-03 1.63949837e-03 1.01674963e-03
  1.50580523e-03 1.11704653e-03 1.38646998e-03 1.60519855e-03
  1.52919538e-03 1.39153419e-03 1.03032967e-03 1.63709239e-03]]
[[0.00383185 0.00310388 0.00195229 0.00229468 0.00130949 0.00400157
  0.00276633 0.00279066 0.00386675 0.00394695 0.00371808 0.00145858
  0.00189965 0.00402711 0.00319851 0.00266321 0.00306442 0.00406659
  0.00270881 0.00142148]
 [0.00659268 0.00539962 0.0041879  0.00527162 0.00171348 0.00748341
  0.0048439  0.00508021 0.00602822 0.00701511 0.00653377 0.00350128
  0.00376443 0.00706802 0.00600865 0.00558185 0.00602483 0.00727584
  0.00207881 0.00219617]
 [0.00731542 0.00624036 0.00454789 0.00574657 0.00430706 0.00874472
  0.00518737 0.00457878 0.00854332 0.00768376 0.00683097 0.00377249
  0.00408135 0.00849268 0.00619833 0.00536256 0.00700857 0.00831638
  0.00563675 0.00405757]
 [0.00414497 0.0037437  0.00272864 0.00310576 0.00140513 0.0045475
  0.00264396 0.00313594 0.00360326 0.00405345 0.00375339 0.00236196
  0.00212952 0.00435523 0.00340793 0.00341325 0.00354801 0.00430837
  0.0012812  0.00081278]
 [0.00759282 0.00618625 0.00581589 0.00700923 0.0038021  0.00989268
  0.0053999  0.0045188  0.0086893  0.00715474 0.00577122 0.00377374
  0.00441173 0.0087596  0.00622466 0.00592702 0.0091499  0.00839483
  0.0049035  0.00353867]
 [0.00416377 0.00095797 0.0043149  0.00459571 0.00069222 0.00618524
  0.00233808 0.00071504 0.00584607 0.00123045 0.0011542  0.00300887
  0.00460633 0.00475919 0.00231078 0.00322408 0.00625644 0.00419389
  0.0025603  0.00073589]
 [0.01634845 0.01556364 0.00865513 0.00980202 0.0061665  0.01824115
  0.00877505 0.01218875 0.01377945 0.0170937  0.01575898 0.0081445
  0.00628584 0.01723677 0.0137679  0.01316703 0.01100969 0.01691022
  0.01382224 0.00417729]
 [0.0007249  0.00071198 0.00029136 0.00026926 0.00016001 0.00082135
  0.00044103 0.00064346 0.00037956 0.00076159 0.00070228 0.00033479
  0.00016361 0.00080093 0.00048007 0.00058318 0.00038747 0.00078867
  0.00044236 0.00010294]
 [0.01550028 0.0158886  0.00624214 0.00883072 0.00581149 0.01515431
  0.00893768 0.01234791 0.01135372 0.01738456 0.01580119 0.00732648
  0.00562807 0.0150903  0.01374763 0.01280459 0.00774466 0.01585466
  0.01232751 0.0032527 ]
 [0.00979537 0.00696047 0.0070895  0.00989622 0.00417377 0.01239742
  0.00715205 0.00644863 0.01043667 0.00856717 0.00793036 0.00568556
  0.0066721  0.01046535 0.00827057 0.00791332 0.01115685 0.01084659
  0.00444534 0.00427503]
 [0.00570287 0.00323881 0.00528206 0.00643954 0.00325991 0.0081609
  0.00400023 0.00125175 0.00733177 0.00336541 0.00200778 0.00367167
  0.00445374 0.00655336 0.0032598  0.00440519 0.00813955 0.00623631
  0.00290348 0.00323986]
 [0.0094427  0.00816947 0.00291021 0.00548499 0.0027583  0.00867715
  0.00562291 0.00661168 0.00698699 0.00959899 0.00888594 0.00341923
  0.0032245  0.00864952 0.00766802 0.00718279 0.0043285  0.00923424
  0.00478267 0.00277634]
 [0.01100929 0.00956256 0.00590529 0.00652203 0.00389944 0.01137288
  0.00704788 0.00830835 0.01010598 0.01102684 0.0098583  0.00458444
  0.00577767 0.01201085 0.00903505 0.00841002 0.00837895 0.01160069
  0.00507779 0.00424268]
 [0.00693493 0.00655529 0.0033833  0.00434013 0.00548681 0.00755986
  0.00504514 0.00494459 0.00613059 0.00805372 0.00663525 0.00290436
  0.0037376  0.0074576  0.00556809 0.0056165  0.00645538 0.00754084
  0.00352873 0.00505118]
 [0.00374071 0.00274582 0.00302001 0.00254459 0.00084729 0.00467531
  0.00192322 0.00218563 0.00343564 0.00303312 0.00278012 0.00250418
  0.00218565 0.00394496 0.00205456 0.00316111 0.0037726  0.00404525
  0.00339801 0.00068844]
 [0.00505544 0.00345917 0.00473324 0.00496117 0.00292437 0.00695306
  0.00265563 0.00139898 0.00548647 0.00371849 0.00299408 0.00351952
  0.00307075 0.00577038 0.00316139 0.00368924 0.00670775 0.00507979
  0.00304371 0.00273997]
 [0.00649499 0.00577711 0.00128028 0.00332588 0.00168092 0.00597554
  0.00447624 0.00545183 0.00515363 0.00684848 0.00629306 0.00262865
  0.00210518 0.00609437 0.00578017 0.00499538 0.00213516 0.00672304
  0.0015741  0.00180034]
 [0.00750265 0.00681611 0.00350145 0.00524326 0.00306838 0.00787315
  0.00505117 0.00578052 0.00620401 0.0075727  0.00678038 0.00349776
  0.00404102 0.00772233 0.00671566 0.00618415 0.00532812 0.00761922
  0.00306659 0.00320903]
 [0.00418728 0.00370949 0.00330882 0.0040526  0.0040092  0.00573803
  0.0029606  0.00159565 0.00523309 0.0038263  0.00273116 0.00258919
  0.00316518 0.00484187 0.0024477  0.00364592 0.005836   0.00492593
  0.00176046 0.00387475]
 [0.0101928  0.00841302 0.0073862  0.00853983 0.00210924 0.01312823
  0.00809138 0.00727981 0.01056512 0.00934956 0.00809048 0.0040037
  0.00526331 0.01253261 0.00807445 0.00773894 0.01047872 0.01195088
  0.00613214 0.00222451]]
[[3.70344001e-02 3.77078958e-02 3.26442688e-02 1.34774118e-02
  3.25635637e-02 5.19504345e-03 2.65034506e-02 6.56869673e-04
  1.73662001e-02 1.28274622e-02 8.88192782e-03 1.56458517e-02
  2.59332345e-02 1.90542683e-02 3.90764731e-02 3.61727319e-02
  6.82683704e-03 2.20048105e-02 3.80653638e-02 1.57074328e-02]
 [2.13489706e-02 1.71611851e-02 1.03286963e-02 1.95652596e-02
  1.67340382e-02 6.04228047e-03 1.27311027e-02 2.15226042e-04
  4.93140885e-03 9.24576299e-03 1.10618573e-02 6.68457727e-03
  1.34994140e-02 1.82784314e-02 2.12338926e-02 1.77966704e-02
  3.35798549e-03 6.67773346e-03 1.50380592e-02 1.09126034e-02]
 [1.94250223e-02 1.62092134e-02 1.29252234e-02 1.82746159e-02
  1.61008406e-02 1.66520960e-03 1.10827126e-02 4.54070338e-04
  3.85075345e-03 1.19939225e-02 5.30191455e-03 9.89224601e-03
  1.45071686e-02 9.88083248e-03 1.99014543e-02 1.90525627e-02
  5.98574106e-03 6.28577035e-03 1.57760615e-02 6.72804071e-03]
 [1.31985941e-02 1.17628656e-02 8.87211158e-03 8.99973049e-03
  1.19889919e-02 2.66210725e-03 5.41861888e-03 2.04480503e-04
  4.89669090e-03 3.83243941e-03 3.86605281e-03 7.36155017e-03
  8.95308785e-03 7.36991382e-03 1.36426681e-02 1.29646499e-02
  3.47645024e-03 5.42778556e-03 1.22168923e-02 8.95236317e-03]
 [2.40569498e-02 2.11520284e-02 1.75720253e-02 2.33050496e-02
  2.02821357e-02 3.64159908e-03 1.15247582e-02 5.66139877e-04
  7.48108536e-03 1.21440304e-02 7.98473437e-03 1.23312316e-02
  1.46625308e-02 1.33559765e-02 2.57131150e-02 2.45301123e-02
  6.02671633e-03 1.13763865e-02 2.12819815e-02 1.28193139e-02]
 [1.48054195e-02 1.28709614e-02 9.43570704e-03 1.32325264e-02
  1.34063771e-02 1.36561558e-03 7.53565674e-03 1.86958437e-04
  6.77439959e-03 5.41612463e-03 2.95607654e-03 5.43739070e-03
  9.70912157e-03 9.87483092e-03 1.59006278e-02 1.42529377e-02
  5.02216209e-03 7.56863176e-03 1.42278815e-02 7.93762128e-03]
 [2.57629898e-02 2.04018825e-02 1.46465776e-02 1.22627567e-02
  1.66913816e-02 6.02120394e-03 1.23784719e-02 3.64879361e-04
  4.89871623e-03 1.77691519e-02 1.44083251e-02 7.20194331e-03
  1.69695408e-02 2.41315087e-02 2.62540669e-02 2.26555444e-02
  3.05311905e-03 7.51873160e-03 2.30376358e-02 1.19098401e-02]
 [1.93394433e-02 1.79578237e-02 1.46096471e-02 1.10365279e-02
  1.66764561e-02 4.24227102e-03 9.59084879e-03 2.15627702e-04
  8.00004609e-03 9.13159746e-03 7.07369162e-03 7.72111966e-03
  1.11107510e-02 1.53408885e-02 2.16387931e-02 1.74138814e-02
  2.88092149e-03 1.35304668e-02 2.11159469e-02 1.15812314e-02]
 [2.22910953e-02 1.57482946e-02 1.12879385e-02 1.81976078e-02
  1.64647966e-02 5.91958522e-03 8.70577063e-03 2.76302664e-04
  5.28086555e-03 1.41611240e-02 1.09981665e-02 7.53452883e-03
  1.65052472e-02 1.88888997e-02 2.23627711e-02 1.95872918e-02
  4.59150166e-03 6.08550460e-03 1.93321725e-02 1.33770639e-02]
 [4.49696655e-03 2.99788962e-03 2.17533271e-03 3.56731963e-03
  3.33982544e-03 8.76572874e-04 9.81917746e-04 7.06161670e-05
  1.35326652e-03 3.27362895e-03 1.75734932e-03 8.42037004e-04
  2.34787345e-03 4.38565407e-03 5.13552244e-03 4.44064323e-03
  5.99491924e-04 2.13578623e-03 4.58857731e-03 2.61097772e-03]]
181
[[0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 3.15769158e-04
  4.62933810e-05 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 9.54696686e-12
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 1.84808493e-13
  1.44606027e-40 0.00000000e+00]
 ...
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 9.33008628e-06
  9.28178281e-16 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 7.85017452e-05
  7.25491774e-07 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 ... 7.76000925e-10
  1.74282751e-10 0.00000000e+00]]
C:\Users\shrey\Desktop\ACAD\DL\DA6401_AS1\T3.py:282: RuntimeWarning: overflow encountered in divide
  weights[j] -= learning_rate*((m_W_hat + weight_decay*weights[j])/(np.sqrt(v_W_hat) + epsilon))
[[3.66866898e-03 2.58983068e-03 4.07903017e-03 3.60231665e-03
  3.13626785e-03 2.61403108e-03 4.31265199e-03 3.09685688e-03
  1.83444649e-03 3.74426236e-03 3.44588593e-03 1.85797664e-03
  3.58885803e-03 3.21989598e-03 3.07650548e-03 2.44577052e-03
  2.24893581e-03 2.50369034e-03 2.45320038e-03 3.50419929e-03]
 [4.35514012e-03 4.22182905e-03 4.75841386e-03 1.31942446e-09
  3.62069500e-03 4.29872762e-03 4.91760592e-03 3.67715453e-03
  3.98255980e-03 4.54222748e-03 4.42686182e-03 2.14046091e-03
  4.47764772e-03 3.18651834e-03 3.65953504e-03 3.97319518e-03
  3.47416785e-03 3.97086679e-03 2.89786136e-03 3.62250716e-03]
 [3.80904216e-03 2.75440812e-03 4.28336555e-03 5.21869089e-03
  3.20337438e-03 3.10316613e-03 5.42566862e-03 3.65741833e-03
  1.83032202e-03 4.58785626e-03 4.52953149e-03 2.29355526e-03
  4.33284303e-03 3.20167380e-03 3.07847211e-03 2.91905178e-03
  2.75022645e-03 3.60522874e-03 3.84161004e-03 4.44698818e-03]
 [6.33483085e-03 7.61931940e-03 7.02752590e-03 4.71888597e-03
  8.16337664e-03 7.81076954e-03 7.03952281e-03 6.97293603e-03
  7.86558047e-03 6.43423542e-03 7.78285001e-03 6.54318526e-03
  6.58741701e-03 6.98805073e-03 6.29219553e-03 7.03140538e-03
  7.52814068e-03 5.81834332e-03 4.85378451e-03 6.65893364e-03]
 [2.05350867e-03 2.02608648e-03 2.29483805e-03 2.64034092e-09
  1.87492074e-03 1.61594274e-03 1.28495450e-03 1.23905832e-03
  1.99291979e-03 1.17157066e-03 2.16533501e-03 1.19243469e-03
  1.49693867e-03 1.38466622e-03 1.85238595e-03 2.02976752e-03
  2.14212592e-03 1.31476981e-03 9.30090904e-04 1.52944751e-03]
 [3.38559943e-03 4.58050733e-03 4.48837899e-03 1.37033740e-03
  4.34196332e-03 5.32828057e-03 2.50176443e-03 3.59903048e-03
  4.80566076e-03 2.15106698e-03 4.40061161e-03 3.54197781e-03
  4.06884353e-03 2.40276874e-03 3.42955496e-03 4.75915592e-03
  4.80388214e-03 2.87593694e-03 2.36253245e-03 4.51128650e-03]
 [6.07511451e-03 5.81778496e-03 5.49771757e-03 5.39469739e-03
  6.13092900e-03 6.00125178e-03 5.15152797e-03 5.71009440e-03
  5.55649962e-03 4.68041618e-03 6.20273511e-03 4.89599045e-03
  6.06406934e-03 5.54166901e-03 5.29926096e-03 5.46409754e-03
  6.08936529e-03 4.47952450e-03 4.60462374e-03 5.69515277e-03]
 [2.16782979e-03 2.67385298e-03 2.54680807e-03 1.08189763e-03
  2.50413879e-03 2.61605422e-03 2.43258288e-03 1.93749133e-03
  2.67037142e-03 2.02971978e-03 2.44198150e-03 2.04122909e-03
  2.34058510e-03 2.28096296e-03 2.23151460e-03 2.56187980e-03
  2.36845036e-03 1.97758928e-03 1.73863963e-03 2.21407343e-03]
 [5.48134081e-03 5.18832326e-03 4.72009062e-03 5.05751012e-03
  4.73027050e-03 4.25437166e-03 4.09173730e-03 4.65589567e-03
  4.23062463e-03 4.32418282e-03 4.51827380e-03 3.78457382e-03
  5.41693801e-03 5.21355300e-03 4.19243595e-03 4.16239748e-03
  4.77618722e-03 2.52284858e-03 4.35573612e-03 5.23031058e-03]
 [1.20034876e-03 1.21955253e-03 1.69322277e-03 2.89682049e-11
  1.15690648e-03 1.15940282e-03 1.88277539e-03 1.39939577e-03
  8.47178033e-04 1.73106899e-03 1.30011867e-03 9.78070768e-04
  1.29583977e-03 1.23890809e-03 6.53342600e-04 7.74206680e-04
  1.13377414e-03 9.96753156e-04 1.09657726e-03 1.55939951e-03]
 [2.35874897e-03 2.46873645e-03 2.10035163e-03 9.30101388e-04
  2.14281657e-03 2.75867868e-03 1.63109855e-03 2.33046602e-03
  2.64741160e-03 1.67429821e-03 2.19087286e-03 2.09537209e-03
  1.86983847e-03 1.60917608e-03 2.23725256e-03 2.33375051e-03
  2.62770266e-03 2.07897448e-03 1.53054743e-03 2.33294943e-03]
 [5.12284137e-03 5.52858622e-03 5.36131409e-03 6.14603990e-03
  5.66243204e-03 5.25243371e-03 6.08399970e-03 5.39047956e-03
  5.14104204e-03 5.73209671e-03 5.97505142e-03 4.46129642e-03
  5.46951601e-03 5.50442335e-03 4.93795117e-03 5.55827075e-03
  6.16941837e-03 3.77676796e-03 4.76384376e-03 6.29019839e-03]
 [4.38870354e-03 3.77462925e-03 4.12063704e-03 4.43668376e-03
  4.60786250e-03 4.56682896e-03 4.18758577e-03 4.12357017e-03
  3.97843372e-03 3.85737595e-03 4.39043977e-03 3.64717500e-03
  3.27232966e-03 3.52776708e-03 3.25465408e-03 4.01393493e-03
  4.18492521e-03 3.34217126e-03 3.25536215e-03 4.18830318e-03]
 [3.70533207e-03 3.66353960e-03 4.30290860e-03 3.66798667e-03
  3.39388568e-03 3.25318078e-03 4.69589813e-03 3.46147828e-03
  3.10662412e-03 4.74256398e-03 4.14906793e-03 1.96044564e-03
  3.90273164e-03 3.74671667e-03 2.81020982e-03 3.36852736e-03
  3.07469626e-03 3.42147246e-03 3.08494988e-03 4.18671051e-03]
 [6.59085419e-03 5.66156350e-03 5.71097285e-03 6.96698155e-03
  6.69602990e-03 5.67596616e-03 5.72110299e-03 6.14227958e-03
  5.51481922e-03 5.51396959e-03 5.34885191e-03 4.42262207e-03
  6.38137310e-03 6.40656527e-03 5.36061498e-03 5.59935475e-03
  6.97857609e-03 4.62671142e-03 4.49983721e-03 6.21448641e-03]
 [3.42946666e-03 3.29880730e-03 3.88604311e-03 4.16047439e-03
  3.82197073e-03 3.47656336e-03 3.70024540e-03 3.13614225e-03
  3.29999394e-03 3.57097704e-03 3.65760254e-03 2.25053279e-03
  3.71142963e-03 3.41216888e-03 2.98909429e-03 3.29133084e-03
  3.34049203e-03 2.93960508e-03 2.98300271e-03 3.75318767e-03]
 [4.93571896e-03 4.06708816e-03 5.37327620e-03 1.14126599e-03
  4.37279484e-03 3.98670597e-03 6.06502722e-03 3.85414726e-03
  3.74762463e-03 4.69309350e-03 4.65731017e-03 3.34888690e-03
  4.29093808e-03 4.77851396e-03 4.08207490e-03 4.09768257e-03
  3.13894055e-03 2.89799891e-03 3.18981377e-03 3.88702340e-03]
 [3.13461608e-03 2.32921692e-03 3.18684856e-03 3.59785719e-03
  2.92380043e-03 2.05366437e-03 3.64035345e-03 2.78176556e-03
  1.09478087e-03 3.55384266e-03 2.90189967e-03 1.87291862e-03
  2.85250080e-03 2.96918237e-03 2.12776646e-03 1.48439144e-03
  2.43826991e-03 1.45848776e-03 2.33493400e-03 3.23453245e-03]
 [1.58056054e-02 1.78847047e-02 1.41045159e-02 1.18936249e-02
  1.93292399e-02 1.82933749e-02 1.44025750e-02 1.73548708e-02
  1.89492839e-02 1.30306049e-02 1.68499371e-02 1.46071891e-02
  1.40415034e-02 1.69682793e-02 1.77668454e-02 1.97129369e-02
  1.91275954e-02 1.17983645e-02 1.10316754e-02 1.59762136e-02]
 [1.42973423e-03 1.82035722e-03 1.89674639e-03 2.46656100e-09
  1.57543826e-03 1.81779886e-03 1.24717401e-03 7.45847208e-04
  1.82436389e-03 1.14120012e-03 1.63461105e-03 1.02686677e-03
  1.50240963e-03 1.11711356e-03 1.38644825e-03 1.60595803e-03
  1.52476953e-03 1.38790536e-03 1.02740392e-03 1.63972377e-03]]
[[0.00384929 0.00313451 0.00194671 0.00230124 0.00130748 0.00401274
  0.00277616 0.0028097  0.00386082 0.00396303 0.00372456 0.00145485
  0.00190957 0.00404574 0.00322097 0.00266927 0.00305711 0.00407776
  0.00270235 0.0014244 ]
 [0.00657948 0.00538896 0.00417549 0.0052644  0.00171646 0.00746421
  0.00482932 0.00507434 0.00601306 0.00699877 0.00652721 0.00349087
  0.0037616  0.00705046 0.00600451 0.00557299 0.00600757 0.00725766
  0.00207419 0.00219138]
 [0.00729642 0.0062215  0.00453517 0.00575843 0.00429404 0.00872193
  0.00517771 0.00456715 0.00853749 0.00766329 0.00681362 0.00376135
  0.00411607 0.00847095 0.00618757 0.00535164 0.00698818 0.00829446
  0.00562067 0.0040453 ]
 [0.00413336 0.00373323 0.00272039 0.00309647 0.00140092 0.00453452
  0.00263669 0.0031276  0.00359245 0.00404214 0.00374333 0.00235488
  0.00212314 0.00434291 0.00339804 0.00340364 0.00353731 0.00429619
  0.0012774  0.00081034]
 [0.00757865 0.0061892  0.00579893 0.0069932  0.00380883 0.00987062
  0.0053913  0.00450773 0.00866583 0.00714402 0.00575378 0.00376284
  0.0044075  0.00873964 0.00620825 0.00591121 0.00912885 0.00837821
  0.00489172 0.0035497 ]
 [0.0041513  0.00095593 0.00430186 0.00458206 0.00069195 0.00616657
  0.00233101 0.00071539 0.00582844 0.00122697 0.00115266 0.00299977
  0.00459247 0.00474496 0.00230532 0.00321465 0.00623755 0.00418125
  0.0025526  0.00073438]
 [0.0162994  0.01551659 0.00862928 0.00977259 0.00615597 0.01818602
  0.00874992 0.01215408 0.01374235 0.01704211 0.0157148  0.00812001
  0.00629383 0.01718582 0.01372893 0.01312817 0.01097796 0.0168591
  0.01378094 0.0041724 ]
 [0.00072562 0.00071217 0.00029049 0.00026896 0.00015964 0.00082112
  0.00044265 0.00064446 0.00037942 0.00076202 0.00070353 0.00033404
  0.00016329 0.00080113 0.00048092 0.00058407 0.00038636 0.00078881
  0.00044119 0.00010267]
 [0.01546138 0.01585848 0.00622327 0.00880821 0.00579518 0.01511338
  0.00891274 0.01231629 0.0113373  0.01733844 0.01575671 0.00730487
  0.00563469 0.01504575 0.0137149  0.01278412 0.00772173 0.01581266
  0.01230542 0.00324815]
 [0.00976698 0.00693946 0.00706937 0.00987362 0.00417873 0.01236052
  0.00713234 0.00643422 0.01040586 0.00854207 0.00790922 0.00566872
  0.00665307 0.01043379 0.00824573 0.00788963 0.01113061 0.01081447
  0.00443238 0.00428018]
 [0.00568683 0.00323127 0.00526614 0.0064201  0.00325715 0.00813773
  0.0039894  0.00124832 0.00731113 0.00335849 0.00200243 0.00366083
  0.0044409  0.00653462 0.00325097 0.00439196 0.00811623 0.00621943
  0.00289471 0.00323586]
 [0.00945004 0.00816159 0.00290141 0.00549468 0.00277106 0.008682
  0.00562007 0.00664773 0.00697033 0.00960228 0.00892547 0.00340899
  0.00322406 0.0086695  0.00771138 0.00718012 0.0043172  0.00923612
  0.00476821 0.002779  ]
 [0.01110039 0.00968999 0.00589747 0.00653824 0.00408329 0.01145078
  0.00710002 0.00831089 0.01011108 0.01113105 0.00984272 0.00457857
  0.00580737 0.01207511 0.00905162 0.00846064 0.0084398  0.01168339
  0.00506645 0.00443877]
 [0.00691434 0.00654256 0.00337707 0.00435326 0.00549607 0.00753737
  0.00503161 0.00494121 0.00611482 0.00802946 0.00663303 0.00289569
  0.00373387 0.00743508 0.00555201 0.00559953 0.00646024 0.00751809
  0.00351847 0.00506682]
 [0.00373366 0.00274251 0.00301088 0.00253744 0.00084525 0.00466455
  0.00192093 0.00218527 0.00342526 0.00302901 0.00277868 0.00249688
  0.00217971 0.00393921 0.00205145 0.00315432 0.00376119 0.00403659
  0.00338781 0.00068647]
 [0.00507226 0.00349502 0.00472278 0.00496981 0.00296841 0.00695705
  0.00268237 0.00139938 0.00546988 0.00375244 0.00298517 0.00350978
  0.0030615  0.00578559 0.00316183 0.00368444 0.00671166 0.00509671
  0.00303462 0.00278969]
 [0.0064795  0.00576109 0.00127642 0.00334477 0.00167953 0.00596391
  0.00446816 0.00543958 0.0051422  0.00683135 0.00628206 0.0026209
  0.0021146  0.00608165 0.00576967 0.00498029 0.0021296  0.00670745
  0.00157042 0.00179919]
 [0.00749155 0.00680748 0.0034921  0.00522811 0.0030815  0.00786
  0.00503922 0.00576517 0.00619476 0.00756385 0.00676075 0.0034872
  0.00404092 0.00770681 0.00669787 0.00616905 0.00532488 0.00760849
  0.00305993 0.00322413]
 [0.00418314 0.00371085 0.00329973 0.00404276 0.00401008 0.00572862
  0.00296005 0.00159144 0.0052188  0.0038261  0.00272306 0.00258182
  0.00315765 0.00483712 0.00244088 0.00363538 0.00582455 0.00491972
  0.00175528 0.00387647]
 [0.0101934  0.00841699 0.00736544 0.00855333 0.00213392 0.01312391
  0.00810861 0.00727734 0.01053854 0.00936332 0.00808117 0.00399176
  0.00525712 0.01253019 0.00807109 0.00771683 0.01045672 0.01194967
  0.00611523 0.00224851]]
[[3.69245189e-02 3.75959510e-02 3.25493399e-02 1.34417477e-02
  3.24663712e-02 5.17934948e-03 2.64302225e-02 6.55106944e-04
  1.73158530e-02 1.27888385e-02 8.85508314e-03 1.55994470e-02
  2.58608015e-02 1.89968308e-02 3.89604939e-02 3.60660501e-02
  6.80642288e-03 2.19386798e-02 3.79530810e-02 1.56600966e-02]
 [2.12991834e-02 1.71276762e-02 1.03039221e-02 1.95231075e-02
  1.66984222e-02 6.02411329e-03 1.27003768e-02 2.14601899e-04
  4.91906596e-03 9.22216698e-03 1.10291552e-02 6.67168806e-03
  1.34607515e-02 1.82326400e-02 2.11876565e-02 1.77602613e-02
  3.34882319e-03 6.65880400e-03 1.49979630e-02 1.08835221e-02]
 [1.95354055e-02 1.63036096e-02 1.29034701e-02 1.84555790e-02
  1.61465115e-02 1.66017720e-03 1.11457847e-02 4.52774321e-04
  3.84423883e-03 1.22342396e-02 5.28985328e-03 9.87638682e-03
  1.44671584e-02 1.01430172e-02 2.00198190e-02 1.91083933e-02
  5.96993535e-03 6.26684760e-03 1.57416771e-02 6.70780603e-03]
 [1.33419374e-02 1.18733808e-02 8.96909141e-03 9.05014219e-03
  1.20724355e-02 2.65787878e-03 5.45589990e-03 2.03864285e-04
  4.94741931e-03 3.82401113e-03 3.85556105e-03 7.55547764e-03
  9.06865929e-03 7.35032551e-03 1.37997489e-02 1.31273657e-02
  3.50470902e-03 5.57590622e-03 1.23696863e-02 9.15441989e-03]
 [2.40567548e-02 2.11981813e-02 1.75503051e-02 2.33051368e-02
  2.02724861e-02 3.63157415e-03 1.15602389e-02 5.65517132e-04
  7.45852072e-03 1.21431445e-02 7.96549874e-03 1.23363166e-02
  1.46337191e-02 1.33780907e-02 2.57193222e-02 2.45308490e-02
  6.00929194e-03 1.13513262e-02 2.12394932e-02 1.27948142e-02]
 [1.47846214e-02 1.28323590e-02 9.43185495e-03 1.32026844e-02
  1.33835362e-02 1.36149619e-03 7.51301346e-03 1.87283254e-04
  6.77631000e-03 5.42095360e-03 2.95056272e-03 5.43188736e-03
  9.72880438e-03 9.84966310e-03 1.58704442e-02 1.42307737e-02
  5.02241445e-03 7.55696341e-03 1.42345851e-02 7.93794329e-03]
 [2.57123562e-02 2.03495501e-02 1.46635738e-02 1.22271341e-02
  1.66984067e-02 6.00300708e-03 1.23411714e-02 3.85431197e-04
  4.90080094e-03 1.77349998e-02 1.43648909e-02 7.28077434e-03
  1.70268677e-02 2.40614475e-02 2.62027944e-02 2.26335833e-02
  3.10548564e-03 7.51646513e-03 2.30544373e-02 1.19151493e-02]
 [1.93240980e-02 1.79369335e-02 1.46050316e-02 1.10048771e-02
  1.66588029e-02 4.22964128e-03 9.58540077e-03 2.15456895e-04
  7.99827481e-03 9.10592675e-03 7.05233015e-03 7.74256844e-03
  1.11425561e-02 1.52953562e-02 2.16136845e-02 1.74126610e-02
  2.88108943e-03 1.35021591e-02 2.10979119e-02 1.15835494e-02]
 [2.22870580e-02 1.57385774e-02 1.12848539e-02 1.82048568e-02
  1.64680667e-02 5.90170010e-03 8.70562729e-03 2.77317908e-04
  5.27550710e-03 1.42123774e-02 1.09649337e-02 7.51377613e-03
  1.65050336e-02 1.88460613e-02 2.23636423e-02 1.95925347e-02
  4.58277975e-03 6.08096500e-03 1.93169542e-02 1.33504032e-02]
 [4.48514937e-03 2.99561150e-03 2.16883960e-03 3.56008976e-03
  3.33117220e-03 8.73942597e-04 9.87763376e-04 7.04030310e-05
  1.34921957e-03 3.26373354e-03 1.75275583e-03 8.40608165e-04
  2.34106251e-03 4.37487739e-03 5.12213742e-03 4.42929672e-03
  5.97750809e-04 2.12933298e-03 4.57478243e-03 2.60309036e-03]]
182
C:\Users\shrey\Desktop\ACAD\DL\DA6401_AS1\T3.py:59: RuntimeWarning: invalid value encountered in matmul
  x = bias[layer] + ( weights[layer] @ x )
C:\Users\shrey\Desktop\ACAD\DL\DA6401_AS1\T3.py:119: RuntimeWarning: invalid value encountered in matmul
  grad_hl = np.matmul(weights[layer].T, grad_al)
C:\Users\shrey\Desktop\ACAD\DL\DA6401_AS1\T3.py:282: RuntimeWarning: invalid value encountered in subtract
  weights[j] -= learning_rate*((m_W_hat + weight_decay*weights[j])/(np.sqrt(v_W_hat) + epsilon))
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
